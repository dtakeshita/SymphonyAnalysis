function Ind = getThresCross(V,th,dir, varargin)
%dir 1 = up, -1 = down
if nargin > 3
    ubd = varargin{1};
else
    ubd = Inf;
end

Vorig = V(1:end-1);
Vshift = V(2:end);

if dir>0
    Ind = find(Vorig<th & Vshift>=th) + 1;
else
    Ind = find(Vorig>=th & Vshift<th) + 1;
end


